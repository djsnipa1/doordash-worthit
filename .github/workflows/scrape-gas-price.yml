name: â›½ Scrape and Commit Gas Price Data

# This defines when the action will run
on:
  # Schedule: Run twice a day (at midnight and noon UTC)
  schedule:
    - cron: "0 0,12 * * *"
  # Manual Trigger: Allows you to run it anytime from the GitHub UI
  workflow_dispatch:

jobs:
  scrape_and_commit:
    runs-on: ubuntu-latest

    steps:
      - name: â¬‡ï¸ Checkout Repository
        # Action to check out your code
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Set up Node.js
        # Set up the Node.js environment your script needs (assuming Node.js)
        uses: actions/setup-node@v4
        with:
          node-version: "20" # Use a modern, stable version
      
      - name: ğŸ—ï¸ Setup pnpm
        uses: pnpm/action-setup@v4
        with:
          version: 10

      - name: ğŸ“¦ Install Dependencies
        # Install any Node.js dependencies (like the Firecrawl SDK or 'node-fetch')
        env:
          PUPPETEER_SKIP_CHROMIUM_DOWNLOAD: 'true'
        run: pnpm install --frozen-lockfile

      - name: ğŸƒ Run Scraper Script
        # Execute your JavaScript file
        run: node src/scrape-vanilla.js

      - name: â¬†ï¸ Commit Updated Data
        uses: EndBug/add-and-commit@v9
        with:
          add: "src/vanilla-extracted-data.json"
          message: "ğŸ¤– Automated data update: Latest Indianapolis gas price. [skip ci]"
          default_author: github_actions